{extend name="../../common/view/public/base" /}
{block name="body"}

<div id="page-wrapper">
  <div class="header">
      <div class="row">
          <div class="col-md-6">
              <h1 class="page-header">
              插件管理
              </h1>
          </div>
          <div class="col-md-6 align-text-bottom">
              {eq name="$Think.session.remote_user_id" value=""}
              <form class="form-horizontal" method="post" action="/admin/plugin/remoteCheck">
                  <div class="control-group">
                      <div class="col-md-6 text-right">
                          <label class="control-label">邮箱</label>
                          <div class="controls"><input id="inputEmail" name="email" placeholder="Email" type="text" /></div>
                      </div>
                      <div class="col-md-3 text-right">
                          <label class="control-label">密码</label>
                          <div class="controls"><input id="inputPassword" name="password" placeholder="Password" type="password" /></div>
                      </div>
                      <div class="col-md-3 text-left">
                          <label class="control-label"> </label>
                          <div class="controls"><button class="btn btn-sm" type="submit">登陆</button>
                              <a href="javascript:;" class="btn btn-sm" onclick="news_list('注册','{:url('/admin/plugin/remoteReg')}','','')">注册</a></div>
                      </div>
                  </div>
              </form>
              {else /}
              <div class="control-group">
                  <div class="col-md-6 text-right">
                      <label class="control-label" contenteditable="true" for="inputEmail"> </label>
                      <div class="controls"><label class="control-label" contenteditable="true">用户远程市场登录信息：</label></div>
                  </div>
                  <div class="col-md-3 text-left">
                      <label class="control-label" contenteditable="true" for="inputPassword"> </label>
                      <div class="controls"><label class="control-label" contenteditable="true">{$Think.session.remote_user_email}已登录</label></div>
                  </div>
                  <div class="col-md-3 text-left">
                      <label class="control-label" contenteditable="true" for="inputPassword"> </label>
                      <div class="controls"></div>
                  </div>
              </div>
              {/eq}
          </div>
      </div>
        <ol class="breadcrumb">
        <li><a href="{:url('index/index')}">Home</a></li>
        <li><a href="{:url('plugin/pluginList')}">插件管理</a></li>
        <li><a href="{:url('plugin/market')}" style="color: red">插件市场</a></li>
        <li class="active">插件市场列表</li>
      </ol>
</div>
<div id="page-inner">

    <table class="table table-hover" style="background-color: #FFFFFF">
        <thead>
        <tr style="background-color:#3E3E3E">
            <th style="color:#FFFFFF" width="5%">ID</th>
            <th style="color:#FFFFFF" width="10%">名称</th>
            <th style="color:#FFFFFF" width="10%">版本</th>
            <th style="color:#FFFFFF" width="10%">作者</th>
            <th style="color:#FFFFFF" width="10%">价格(元)</th>
            <th style="color:#FFFFFF" width="25%">描述</th>
            <th style="color:#FFFFFF" width="10%">发布时间</th>
            <th style="color:#FFFFFF" width="10%">操作</th>
        </tr>
        </thead>
        <tbody>
        {volist name="plugins" id="plugin"}
        <form action="/admin/plugin/orderpay" method="post">
            <tr>
                <th scope="row">{$plugin.id}</th>
                <td>{$plugin.name}</td>
                <td>
                    <select name="version">
                        {volist name="$plugin.version" id="ver"}
                        <option value="{$ver.id}">{$ver.version}</option>
                        {/volist}
                    </select>
                </td>
                <td>{$plugin.author}</td>
                <td>{eq name="$plugin.money" value="0"}<label style="color: green">免费</label>{else /}<label style="color: red">{:number_format($plugin.money,2,".","")}</label>{/eq}</td>
                <td>{$plugin.description}</td>
                <td>{$plugin.create_time|date='Y-m-d H:i'}</td>
                <td>
                    {eq name="$plugin.appkey|pluginCount" value="0"}
                    <input type="submit" class="btn btn-xs btn-primary" value="安装" onclick="return confirm('\'确认安装吗?\'')">
                    {else /}
                    <input type="button" class="btn btn-xs btn-default disabled" value="已安装">
                    {/eq}
                </td>
            </tr>
            <input type="hidden" name="product_id" value="{$plugin.id}">
            <input type="hidden" name="body" value="{$plugin.name}">
            <input type="hidden" name="total_fee" value="{$plugin.money}">
        </form>
        {/volist}
        </tbody>
    </table>

    <!--layer弹层-->
    <script type="text/javascript" src="/static/assets/layer/2.4/layer.js"></script>

    <script type="text/javascript">
        function news_show(title,url,id,w,h){
            layer_show(title,url,w,h);
        }
        function news_list(title,url,w,h){
            layer_show(title,url,w,h);
        }
        /*弹出层*/
        /*
            参数解释：
            title	标题
            url		请求的url
            id		需要操作的数据id
            w		弹出层宽度（缺省调默认值）
            h		弹出层高度（缺省调默认值）
        */
        function layer_show(title,url,w,h){
            if (title == null || title == '') {
                title=false;
            };
            if (url == null || url == '') {
                url="404.html";
            };
            if (w == null || w == '') {
                w=800;
            };
            if (h == null || h == '') {
                h=($(window).height() - 50);
            };
            layer.open({
                type: 2,
                area: [w+'px', h +'px'],
                fix: false, //不固定
                maxmin: true,
                shade:0.4,
                title: title,
                content: url
            });
        }

        /*关闭弹出框口*/
        function layer_close(){
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        }
    </script>

    {/block}
